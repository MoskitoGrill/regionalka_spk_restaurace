<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurace ve městě</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo" />
  </header>
  <div class="program-bar" id="program-bar">
    <span id="currentProgram">Načítání aktuálního programu...</span>
  </div>
  <main>
    <div class="filter-bar">
    <button class="filter-button active" data-category="all">Vše</button>
    <button class="filter-button" data-category="pizza">Pizza</button>
    <button class="filter-button" data-category="burger">Burger</button>
    <button class="filter-button" data-category="těstoviny">Těstoviny</button>
    </div>
    <div class="vertical-filter-bar">
    <button class="vertical-filter-button" data-category="čína">Čína</button>
    <button class="vertical-filter-button" data-category="sendvič">Sendvič</button>
    <button class="vertical-filter-button" data-category="kebab">Kebab</button>
    </div>

  <div class="main-content">
    <div class="restaurant-card" data-category="pizza těstoviny"> <!--kategorie-->
      <div class="card-top">
        <div class="card-text">
          <h2>Pizzeria Istria</h2><!--název-->
          <p>Pizza, Těstoviny</p><!--kategorie popisek-->
          <p><strong>Adresa:</strong> <a href="https://maps.google.com/?q=Hlavní třída+11,+Šumperk" target="_blank">Hlavní tř. 11/7</a></p><!--odkaz a adresa-->
          <p><strong>Web:</strong> <a href="https://pizzasumperk.cz/" target="_blank">pizzasumperk.cz</a></p><!--Webovky-->
          <p><strong>Tel:</strong> 608 161 229</p><!--telefon-->
          <p><strong>Cena:</strong> Kč 150–200</p><!--cena-->
        </div>
        <div class="card-description">
            <p class="restaurant-description">
            Istrie je dobrá volba, pokud máte chuť na skvělou pizzu či italské těstoviny – špagety, lasagne, ale také gnocci. Dá se sedět vevnitř nebo, pokud je zrovna volno, venku. Obě varianty jsou ale velmi příjemné.
            </p>
        </div>
      </div>
      <div class="card-map" id="map1-container">
        <button class="fullscreen-button" onclick="toggleFullscreen(this, 'map1')">⛶</button>
        <div id="map1" style="height: 100%;"></div>
      </div>
    </div>
    <div class="restaurant-card" data-category="burger sendvič"> <!--kategorie-->
      <div class="card-top">
        <div class="card-text">
          <h2>Cakir's Burger</h2><!--název-->
          <p>Burger, Sendvič</p><!--kategorie popisek-->
          <p><strong>Adresa:</strong> <a href="https://maps.google.com/?q=nám. Míru+22,+Šumperk" target="_blank">nám. Míru 22</a></p><!--odkaz a adresa-->
          <p><strong>Web:</strong> <a href="https://www.cakirs.cz/#home" target="_blank">cakirs.cz</a></p><!--Webovky-->
          <p><strong>Tel:</strong> 775 100 935</p><!--telefon-->
          <p><strong>Cena:</strong> Kč 150–400</p><!--cena-->
        </div>
        <div class="card-description">
            <p class="restaurant-description">
            V nabídce naleznete různé druhy burgerů. K nim si můžete dát domácí hranolky nebo saláty.
            </p>
        </div>
      </div>
      <div class="card-map" id="map2-container">
        <button class="fullscreen-button" onclick="toggleFullscreen(this, 'map2')">⛶</button>
        <div id="map2" style="height: 100%;"></div><!--mapaid-->
      </div>
    </div>
  </div>

  
  <script>
    const allFilterButtons = document.querySelectorAll(".filter-button, .vertical-filter-button");
    const cards = document.querySelectorAll(".restaurant-card");

    allFilterButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        document.querySelector(".filter-button.active")?.classList.remove("active");
        document.querySelector(".vertical-filter-button.active")?.classList.remove("active");

        btn.classList.add("active");

        const category = btn.dataset.category;
        cards.forEach(card => {
        card.style.display = (category === "all" || card.dataset.category.includes(category)) ? "block" : "none";
        });
    });
    });
    
    const startLatLng = [49.963984, 16.974440];//výchozí bod
    const startIcon = L.icon({
        iconUrl: 'vychozi_bod.png',
        iconSize: [35, 41],
        iconAnchor: [12, 41],
        popupAnchor: [0, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        shadowSize: [41, 41],
        shadowAnchor: [12, 41]
        });

        const endIcon = L.icon({
        iconUrl: 'cilovy_bod.png',
        iconSize: [35, 41],
        iconAnchor: [12, 41],
        popupAnchor: [0, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        shadowSize: [41, 41],
        shadowAnchor: [12, 41]
        });


    const map1 = L.map('map1').setView([49.965792201057205, 16.97573241815665], 14); //souřadnice restaurace
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data © OpenStreetMap contributors'
    }).addTo(map1);

    L.marker(startLatLng, { icon: startIcon }).addTo(map1).bindPopup("Start");
    L.marker([49.965792201057205, 16.97573241815665], { icon: endIcon }).addTo(map1).bindPopup("Pizzeria Istria"); //souřadnice restaurace + název

    L.Routing.control({
      waypoints: [
        L.latLng(startLatLng),
        L.latLng(49.965792201057205, 16.97573241815665) //souřadnice restaurace
      ],
      router: L.Routing.osrmv1({
        serviceUrl: 'https://router.project-osrm.org/route/v1',
        profile: 'foot'
      }),
      routeWhileDragging: false,
      show: false,
      addWaypoints: false,
      createMarker: () => null,
      lineOptions: {
        styles: [{ color: '#2f3b45', weight: 5 }]
      }

    }).addTo(map1);

    const map2 = L.map('map2').setView([49.96585802665727, 16.97147024907664], 14); //souřadnice restaurace
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data © OpenStreetMap contributors'
    }).addTo(map2);

    L.marker(startLatLng, { icon: startIcon }).addTo(map2).bindPopup("Start");
    L.marker([49.96585802665727, 16.97147024907664], { icon: endIcon }).addTo(map2).bindPopup("Cakir's Burger"); //souřadnice restaurace + název

    L.Routing.control({
      waypoints: [
        L.latLng(startLatLng),
        L.latLng(49.96585802665727, 16.97147024907664) //souřadnice restaurace
      ],
      router: L.Routing.osrmv1({
        serviceUrl: 'https://router.project-osrm.org/route/v1',
        profile: 'foot'
      }),
      routeWhileDragging: false,
      show: false,
      addWaypoints: false,
      createMarker: () => null,
      lineOptions: {
        styles: [{ color: '#2f3b45', weight: 5 }]
      }

    }).addTo(map2);

    function toggleFullscreen(button, mapId) {
      const container = button.parentElement;
      const isFullscreen = container.classList.toggle("fullscreen");

      document.querySelectorAll(".leaflet-control-container").forEach(el => {
        const parentMap = el.closest(".card-map");
        if (parentMap !== container && isFullscreen) {
          el.style.display = "none";
        } else {
          el.style.display = "";
        }
      });

      document.querySelectorAll(".fullscreen-button").forEach(btn => {
        const parentMap = btn.closest(".card-map");
        if (parentMap !== container && isFullscreen) {
          btn.style.display = "none";
        } else {
          btn.style.display = "";
        }
      });

      setTimeout(() => {
        const map = mapId === 'map1' ? map1 : mapId === 'map2' ? map2 : null;
        if (map) map.invalidateSize();
      }, 300);
    }
    const schedule = [
      { start: "09:00", end: "10:10", name: "Registrace" },
      { start: "10:15", end: "10:25", name: "Přivítání" },
      { start: "10:30", end: "11:00", name: "Icebreakery" },
      { start: "11:05", end: "11:30", name: "Chvály" },
      { start: "11:35", end: "12:35", name: "Semináře" },
      { start: "12:40", end: "14:40", name: "Oběd" },
      { start: "14:40", end: "16:30", name: "Workshopy" },
      { start: "16:35", end: "16:50", name: "Chvály" },
      { start: "16:55", end: "17:50", name: "Slovo" },
      { start: "17:55", end: "18:05", name: "Chvály" },
      { start: "18:10", end: "20:30", name: "Závěrečný program" }
    ];

    function getCurrentAndNextBlock(schedule) {
      const now = new Date();
      const currentMinutes = now.getHours() * 60 + now.getMinutes();

      let current = null;
      let next = null;

      for (let i = 0; i < schedule.length; i++) {
        const block = schedule[i];
        const [startH, startM] = block.start.split(":").map(Number);
        const [endH, endM] = block.end.split(":").map(Number);
        const startMin = startH * 60 + startM;
        const endMin = endH * 60 + endM;

        if (currentMinutes >= startMin && currentMinutes < endMin) {
          current = block;
          next = schedule[i + 1] || null;
          break;
        } else if (currentMinutes < startMin) {
          // mezera mezi bloky
          current = null;
          next = block;
          break;
        }
      }

      return { current, next };
    }

    function updateProgramBar() {
      const { current, next } = getCurrentAndNextBlock(schedule);
      const bar = document.getElementById("program-bar");

      if (current && next) {
        bar.textContent = `${current.start} - ${current.end} ${current.name} → ${next.start} - ${next.end} ${next.name}`;
      } else if (current && !next) {
        bar.textContent = `${current.start} - ${current.end} ${current.name}`;
      } else if (!current && next) {
        bar.textContent = `→ ${next.start} - ${next.end} ${next.name}`;
      } else {
        bar.textContent = "Program ukončen.";
      }
    }
    document.getElementById("program-bar").addEventListener("click", () => {
      alert("Zde se později zobrazí celý program. (Plakát)");
    });
    updateProgramBar();
    setInterval(updateProgramBar, 60000); // aktualizace každou minutu
  </script>
  </main>
  <footer>
    <div class="footer-left">
        <div>Zpátky do sboru</div>
        <div><a href="https://maps.google.com/?q=M.R.Štefánika+10a,+787+01+Šumperk" target="_blank">M. R. Štefánika 10a</a></div>
    </div>
    <div class="footer-right">
        <a href="https://www.instagram.com/volant_spk" target="_blank">
        <img src="instagram_icon.png" alt="Instagram logo">
        <span>Volant_spk</span>
        </a>
    </div>
  </footer>

</body>
</html>
